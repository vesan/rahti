<!DOCTYPE html>
<html>
  <body>
    <script type="module">
      import { state, effect, html, svg, onCleanup, event, createRoot } from "./main.js";
      const { h1, button, p, ol, li, strong, div } = html;

      const app = effect((root) => {
        const [count, { increment, decrement }] = counter(0);

        const numbers = [];
        for (let index = 0; index < count; index++) {
          numbers.push(listItem(index + 1));
        }

        root(
          h1("Count: ", count),
          button("+1", event("click", increment)),
          button("-1", event("click", decrement)),
          count === 0 && p("Try the buttons!"),
          count > 0 && ol(...numbers),
          count < 0 &&
            div(
              svg.svg(
                svg.rect({ width: 300, height: 300, fill: "red" }),
                svg.text("Surprise svg!", { x: 50, y: 50, fill: "white" })
              )
            )
        );
      });

      const counter = state(0, (get, set) => ({
        increment: () => set(get() + 1),
        decrement: () => set(get() - 1),
      }));

      const listItem = effect((number) => {
        const [count, { increment }] = counter(0);

        // const timer = setInterval(increment, 1000);
        onCleanup(() => {
          increment();
          //   clearInterval(timer);
        });

        return li("has cleaned ", strong(`${count} times`));
      });

      app(createRoot(document.body));
    </script>
  </body>
</html>
